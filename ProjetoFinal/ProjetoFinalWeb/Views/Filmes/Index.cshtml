@model IEnumerable<ProjetoFinalWeb.Models.FilmesModel>

@{
    ViewBag.Title = "Filmes";

}
<div class="svg-wrapper">
    <svg height="60" width="320" xmlns="http://www.w3.org/2000/svg">
        <rect class="shape" height="60" width="320" />
        <div class="text">Filmes</div>
    </svg>
</div>

<div class="centralizar">
    <a href="/Home/Index" class="btn-home" style="position: absolute; top: 0px; right: 10px;">
        <h3 class="btn btn-default"><span class="glyphicon glyphicon-home"> Home</span></h3>
    </a>

    <div style="clear: both;"></div>

    <form id="buscarFilme" method="post" action="/BuscarItens" class="form-inline" style="margin: 40px;">
        <div class="form-group">
            <input type="text" id="nome" class="form-control" name="nome" placeholder="Digite o nome do filme..." required />
        </div>
        <button type="submit" class="btn btn-default btn-sm" /><span class="glyphicon glyphicon-search"></span> BUSCAR</button>
    </form>
</div>

@{ var erro = @ViewBag.Erro2; }

@if (@erro == "SIM")
{

    <div class="conteiner_erro">
        <p class="texto_erro">@ViewBag.Erro</p>
        <img src="~/images/zelda.png" class="img_erro" />
    </div>
}


<ul class="lista_filmes"></ul>
<div style="clear: both;"></div>
<script>

    $("#nome").autocomplete({
        source: '/Filmes/Buscar',
        minLength: 2,
        select: function (event, ui) {
            var params = {
                url: ui.item ? '/Filmes/BuscarItem' : '/Filmes/BuscarItens',
                data: 'nome=' + (ui.item ? ui.item.value : this.value)
            };
            buscarFilmes(params);
        }
    });

    $('#buscarFilme').submit(function (e) {
        e.preventDefault();
        var params = {
            url: '/Filmes/BuscarItens',
            data: $(this).serialize()
        };
        buscarFilmes(params);

        return false;
    });

    function buscarFilmes(params) {
        $.ajax({
            method: 'post',
            url: params.url,
            data: params.data,
            success: function (data) {
                $('.lista_filmes').html(data);
            },
            error: function (err) {
                console.log(err);
            }
        });
    }

</script>
